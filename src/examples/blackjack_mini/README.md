# ะะฐััะพัะฝะฐั ะธะณัะฐ "Blackjack"
ะัะธะผะตะฝะตะฝะธะต ะผะตัะพะดะพะฒ `Monte Carlo` ะธ `Sarsa(ฮป)` ะฝะฐ ะฟัะธะผะตัะต ะบะฐััะพัะฝะพะน ะธะณัั "Blackjack" ั ัะฟัะพัะตะฝะฝัะผะธ ะฟัะฐะฒะธะปะฐะผะธ.

## ะัะฐะฒะธะปะฐ

+ ะะณัะฐ ะธะณัะฐะตััั ั ะฑะตัะบะพะฝะตัะฝะพะน ะบะพะปะพะดะพะน (ั.ะต. ะบะฐััั ะฒัะฑะธัะฐัััั ยซั ะฒะพะทะฒัะฐัะพะผยป)
+ ะะฐะถะดะฐั ะบะฐััะฐ, ะฒัะฑะธัะฐะตะผะฐั ะธะท ะบะพะปะพะดั, ะธะผะตะตั ััะพะธะผะพััั ะพั 1 ะดะพ 10 (ะฒะตัะพััะฝะพััั ะฒััะฐัะธัั
ะปัะฑะพะต ะทะฝะฐัะตะฝะธะต โ 1/10), ะฐ ัะฐะบะถะต ะปะธะฑะพ ะบัะฐัะฝัะน ัะฒะตั (ั ะฒะตัะพััะฝะพัััั 1/3), ะปะธะฑะพ ัะตัะฝัะน (ั
ะฒะตัะพััะฝะพัััั 2/3)
+ ะ ะบะพะปะพะดะต ะฝะตั ััะทะพะฒ ะธ ะบะฐัั ั ะฟะตััะพะฝะฐะถะฐะผะธ
+ ะ ะฝะฐัะฐะปะต ะธะณัั ัะดะฐััะธะน ะธ ะธะณัะพะบ ะดะพััะฐัั ะฟะพ ะพะดะฝะพะน ัะตัะฝะพะน ะบะฐััะต ะธ ะบะปะฐะดัั ะตะต ะปะธัะพะผ ะฒะฒะตัั
+ ะะพ ะฒัะตะผั ะบะฐะถะดะพะณะพ ัะพะดะฐ ะธะณัะพะบ ะผะพะถะตั ะฒัะฟะพะปะฝะธัั ะพะดะฝะพ ะธะท ะดะฒัั ะดะตะนััะฒะธะน, ะบะพัะพััะต ะผั ะฑัะดะตะผ
ะพะฑะพะทะฝะฐัะฐัั ะบะพะดะพะฒัะผะธ ะฝะฐะทะฒะฐะฝะธัะผะธ ยซะตัะตยป ะธ ยซัะฒะฐัะธัยป
+ ะัะปะธ ะธะณัะพะบ ะฒัะฟะพะปะฝัะตั ะดะตะนััะฒะธะต ยซะตัะตยป, ัะพ ะพะฝ ะฑะตัะตั ะพะดะฝั ะบะฐััั ะธะท ะบะพะปะพะดั
+ ะัะปะธ ะธะณัะพะบ ะฒัะฟะพะปะฝัะตั ะดะตะนััะฒะธะต ยซัะฒะฐัะธัยป, ัะพ ัะพะด ะฟะตัะตัะพะดะธั ัะดะฐััะตะผั
+ ะกัะผะผะฐ ะพัะบะพะฒ ะฒััะธัะปัะตััั ัะปะตะดัััะธะผ ะพะฑัะฐะทะพะผ: ะทะฝะฐัะตะฝะธั ัะตัะฝัั ะบะฐัั ะฟัะธะฑะฐะฒะปััััั, ะฐ
ะบัะฐัะฝัั โ ะฒััะธัะฐัััั ะธะท ะพะฑัะตะน ััะผะผั
+ ะัะปะธ ััะผะผะฐ ะพัะบะพะฒ ะฟัะตะฒััะฐะตั 21 ะธะปะธ ััะฐะฝะพะฒะธััั ะพััะธัะฐัะตะปัะฝะพะน, ัะพ ะธะณัะพะบ ะฟัะพะธะณััะฒะฐะตั
(ะฟะพะปััะฐะตั ะฝะฐะณัะฐะดั -1) ะธ ะธะณัะฐ ะทะฐะบะฐะฝัะธะฒะฐะตััั
+ ะกะดะฐััะธะน ะฒัะตะณะดะฐ ะฝะฐะฑะธัะฐะตั ะบะฐััั, ะฟะพะบะฐ ะฝะต ะฟะพะปััะธั ััะผะผั ะพัะบะพะฒ, ัะฐะฒะฝัั ะธะปะธ ะฟัะตะฒะพััะพะดัััั 17. ะัะปะธ ัะดะฐััะธะน ะฝะฐะฑะธัะฐะตั ะฑะพะปััะต 21 ะธะปะธ ะผะตะฝััะต 0 ะพัะบะพะฒ, ัะพ ะพะฝ ะฟัะพะธะณััะฒะฐะตั, ะฐ ะธะณัะพะบ
ะฒัะธะณััะฒะฐะตั (ะฟะพะปััะฐะตั ะฝะฐะณัะฐะดั +1). ะ ะฟัะพัะธะฒะฝะพะผ ัะปััะฐะต ะฟะพะฑะตะดะฐ ะพะฟัะตะดะตะปัะตััั ะฟะพ ััะผะผะต
ะพัะบะพะฒ: ั ะบะพะณะพ ะฑะพะปััะต, ัะพั ะธ ะฒัะธะณัะฐะป. ะะธััั ะฟัะธะฝะพัะธั ะฝัะปะตะฒัั ะฝะฐะณัะฐะดั

## ะะตะทัะปััะฐัั

### `Monte Carlo` (500 000 ัะฟะธะทะพะดะพะฒ)

+ ะัะฐัะธะบ ััะฝะบัะธะธ ัะพััะพัะฝะธั:
![state function graph](https://github.com/Oginsky/reinforcement_learning/raw/main/data/graphs/blackjack_mini/value_function_500k_episodes.png)
---

### `Sarsa(ฮป)` (10 000 ัะฟะธะทะพะดะพะฒ)

<details>
<summary>ะัะธะฒะฐั ะพะฑััะตะฝะธั (ฮป = 0.0)</summary>
<img alt="learning curve graph" src="https://github.com/Oginsky/reinforcement_learning/raw/main/data/graphs/blackjack_mini/mse_episode_lambda=0_10000.png" alt=""></img>
</details>

<details>
<summary>ะัะธะฒะฐั ะพะฑััะตะฝะธั (ฮป = 1.0)</summary>
<img alt="learning curve graph" src="https://github.com/Oginsky/reinforcement_learning/raw/main/data/graphs/blackjack_mini/mse_episode_lambda=1_10000.png" alt=""></img>
</details>

<details>
<summary>ะะฐะฒะธัะธะผะพััั ััะตะดะฝะตะบะฒะฐะดัะฐัะธัะตัะบะพะน ะพัะธะฑะบะธ ะพั ฮป</summary>
<img alt="learning curve graph" src="https://github.com/Oginsky/reinforcement_learning/raw/main/data/graphs/blackjack_mini/mse_on_lambda_10000e.png" alt=""></img>
</details>

---


## ะะธะฝะตะนะฝะฐั ะฐะฟะฟัะพะบัะธะผะฐัะธั ะฝะฐ ะพัะฝะพะฒะต ะณััะฑะพะณะพ ะบะพะดะธัะพะฒะฐะฝะธั (coarse coding)

> ะ ััะพะผ ัะฐะทะดะตะปะต ะฟัะธะฒะพะดัััั ัะตะทัะปััะฐัั ะฐะฟะฟัะพะบัะธะผะฐัะธะธ ัะพััะพัะฝะธั ะฐะณะตะฝัะฐ. 
> ะัะฟะพะปัะทัะตััั ะฑะธะฝะฐัะฝัะน ะฒะตะบัะพั ะฟัะธะทะฝะฐะบะพะฒ ๐(๐, ๐) ั 3 โ 6 โ 2 = 36 ะฟัะธะทะฝะฐะบะฐะผะธ. ะะฐะถะดัะน
> ะฑะธะฝะฐัะฝัะน ะฟัะธะทะฝะฐะบ ะธะผะตะตั ะทะฝะฐัะตะฝะธะต 1, ะตัะปะธ (๐, ๐) ะปะตะถะธั ะฒ ะบัะฑะพะธะดะต ัะพััะพัะฝะธั, ัะพะพัะฒะตัััะฒัััะตะณะพ
> ััะพะผั ะฟัะธะทะฝะฐะบั, ะธ ะดะตะนััะฒะธั, ัะพะพัะฒะตัััะฒัััะตะผั ััะพะผั ะฟัะธะทะฝะฐะบั. ะัะฑะพะธะดั ะธะผะตัั ัะปะตะดัััะธะต
> ะฟะตัะตัะตะบะฐััะธะตัั ะธะฝัะตัะฒะฐะปั:

> ๐๐๐๐๐๐(๐) = {[1,4],[4,7],[7,10]} <br>
> ๐๐๐๐ฆ๐๐(๐) = {[1,6],[4,9],[7,12],[10,15],[13,18],[16,21]} <br>
> ๐ = {โ๐๐ก, ๐๐ก๐๐๐} <br>

> ััะฝะบัะธะธ ัะตะฝะฝะพััะธ ะฐะฟะฟัะพะบัะธะผะธััะตััั: <br>
> ๐(๐, ๐) = ๐(๐, ๐)๐ฮธ

### `Monte Carlo` (100 000 ัะฟะธะทะพะดะพะฒ)

+ ะัะฐัะธะบ ััะฝะบัะธะธ ัะพััะพัะฝะธั:
![state function graph](https://github.com/Oginsky/reinforcement_learning/raw/main/data/graphs/blackjack_mini/linear_value_function_100k_episodes.png)
---

### `Sarsa(ฮป)` (10 000 ัะฟะธะทะพะดะพะฒ)

<details>
<summary>ะัะธะฒะฐั ะพะฑััะตะฝะธั (ฮป = 0.0)</summary>
<img alt="learning curve graph" src="https://github.com/Oginsky/reinforcement_learning/raw/main/data/graphs/blackjack_mini/linear_mse_episode_lambda=0_10000.png" alt=""></img>
</details>

<details>
<summary>ะัะธะฒะฐั ะพะฑััะตะฝะธั (ฮป = 1.0)</summary>
<img alt="learning curve graph" src="https://github.com/Oginsky/reinforcement_learning/raw/main/data/graphs/blackjack_mini/linear_mse_episode_lambda=1_10000.png" alt=""></img>
</details>

<details>
<summary>ะะฐะฒะธัะธะผะพััั ััะตะดะฝะตะบะฒะฐะดัะฐัะธัะตัะบะพะน ะพัะธะฑะบะธ ะพั ฮป</summary>
<img alt="learning curve graph" src="https://github.com/Oginsky/reinforcement_learning/raw/main/data/graphs/blackjack_mini/linear_mse_on_lambda_10000e.png" alt=""></img>
</details>